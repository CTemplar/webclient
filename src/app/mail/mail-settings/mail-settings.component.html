<div class="mailbox-sub-content" #settingsContent>
  <div
    ngbNav
    #navSet="ngbNav"
    class="nav-tabs"
    [(activeId)]="selectedTabQueryParams"
    (navChange)="navigateToTab($event)"
  >
    <!-- Dashboard and Plans -->
    <div class="nav" [ngbNavItem]="'dashboard-and-plans'">
      <a ngbNavLink class="nav-link" [translate]="'settings.dashboard_plans'"> Dashboard & Plans </a>
      <ng-template ngbNavContent>
        <!-- Overview Section -->
        <section class="mailbox-section mt-4">
          <div class="mailbox-section-body pt-0">
            <div class="desc-card-holder mt-sm-3 mt-md-0">
              <!--START Plan details -->
              <div id="plan-details" class="mb-4 row plan-details">
                <div class="col-12">
                  <div class="desc-card">
                    <div class="desc-card-header ui-header ui-header-bordered border-all-corner border-bottom-0">
                      <h5 class="ui-header-subtitle text-dark mb-0">
                        <a class="anchor" aria-hidden="true" (click)="onAnchoredLink('plan-details')">
                          <svg
                            class="octicon octicon-link"
                            viewBox="0 0 16 16"
                            version="1.1"
                            width="16"
                            height="16"
                            aria-hidden="true"
                          >
                            <path
                              fill-rule="evenodd"
                              d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"
                            ></path>
                          </svg>
                        </a>
                        <strong [translate]="'settings.plan_details'">Plan Details</strong>
                      </h5>
                    </div>
                    <div class="desc-card-body">
                      <div class="row">
                        <div class="col-md-5 col-sm-12">
                          <div align="center" class="subscription">
                            <div class="subscription-tag">
                              {{ userPlanType }}
                            </div>
                            <div>
                              <i class="far fa-credit-card"></i>
                            </div>
                            <div>
                              <a
                                (click)="scroll(targetUpgrade)"
                                class="btn btn-gradient-primary cursor-pointer"
                                [translate]="'settings.upgrade'"
                              >
                                Upgrade
                              </a>
                            </div>
                          </div>
                        </div>
                        <div class="col-md-7 col-sm user-details">
                          <ul class="info-list list-styled text-dark">
                            <li class="info-list-item">
                              <div class="info-list-text info-list-label" [translate]="'settings.username'">
                                Username
                              </div>
                              <div class="info-list-text info-list-val">{{ userState.username }}</div>
                            </li>
                            <li class="info-list-item">
                              <div class="info-list-text info-list-label">Recovery Email</div>
                              <div class="info-list-text info-list-val" *ngIf="userState.isLoaded">
                                <div class="row" *ngIf="isEditingRecoveryEmail; else recoveryEmailTemplate">
                                  <form autocomplete="off" class="col-10">
                                    <input
                                      class="form-control form-control-sm"
                                      id="recoveryMail"
                                      type="email"
                                      name="email"
                                      autocomplete="off"
                                      [(ngModel)]="settings.recovery_email"
                                      [ngModelOptions]="{ updateOn: 'blur' }"
                                      (change)="updateSettings('recovery_email', $event.target.value)"
                                      placeholder="example@mail.com"
                                    />
                                  </form>
                                  <a class="col-2 align-self-center -underline" (click)="toggleRecoveyEmailEdit()">
                                    <u>Save</u>
                                  </a>
                                </div>
                                <ng-template #recoveryEmailTemplate class="-align-right">
                                  <div class="row" *ngIf="settings.recovery_email; else addRecoveryEmailTemplate">
                                    <div class="col-10 info-list-text info-list-val">
                                      {{ settings.recovery_email }}
                                    </div>
                                    <a class="col-2" (click)="toggleRecoveyEmailEdit()">
                                      <u>Edit</u>
                                    </a>
                                  </div>
                                  <ng-template #addRecoveryEmailTemplate>
                                    <a (click)="toggleRecoveyEmailEdit()">
                                      <u>Add</u>
                                    </a>
                                  </ng-template>
                                </ng-template>
                              </div>
                            </li>
                            <li class="info-list-item">
                              <div class="info-list-text info-list-label" [translate]="'settings.domains'">Domains</div>
                              <div class="info-list-text info-list-val">
                                <span *ngIf="userState.isPrime">{{ settings?.domain_count }}</span>
                                <span *ngIf="!userState.isPrime" [translate]="'settings.none'">None</span>
                              </div>
                            </li>
                            <li class="info-list-item align-items-start">
                              <div class="info-list-text info-list-label" [translate]="'settings.addresses'">
                                Aliases
                              </div>
                              <div class="info-list-text info-list-val">
                                <div
                                  *ngIf="userState.isPrime"
                                  class="ng-tooltips-holder d-inline-block"
                                  placement="top"
                                >
                                  <div class="info-list-val-text" [translate]="'settings.address_tooltip'">
                                    {{ settings?.email_count }}
                                  </div>
                                </div>
                                <div *ngIf="!userState.isPrime" class="d-inline-block">
                                  <div class="info-list-val-text" [translate]="'settings.address_one'">One</div>
                                </div>
                              </div>
                            </li>
                            <li class="info-list-item">
                              <div class="info-list-text info-list-label" [translate]="'settings.storage'">Storage</div>
                              <div class="info-list-text info-list-val">
                                <div class="info-list-val-text">
                                  {{ settings?.used_storage | filesize }} of
                                  {{ settings?.allocated_storage | filesize }}
                                </div>
                                <div class="progress progress-secondary progress-lg">
                                  <div
                                    class="progress-bar"
                                    role="progressbar"
                                    [style.width.%]="(settings.used_storage / settings.allocated_storage) * 100"
                                    [attr.aria-valuenow]="settings.used_storage"
                                    aria-valuemin="0"
                                    [attr.aria-valuemax]="settings.allocated_storage"
                                  ></div>
                                </div>
                              </div>
                            </li>
                          </ul>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!--END Plan details -->
              <div id="my-subscription" class="row">
                <div class="col-md-6">
                  <div class="desc-card">
                    <div class="desc-card-header ui-header ui-header-bordered border-all-corner border-bottom-0">
                      <h5 class="ui-header-subtitle text-dark mb-0">
                        <a class="anchor" aria-hidden="true" (click)="onAnchoredLink('my-subscription')">
                          <svg
                            class="octicon octicon-link"
                            viewBox="0 0 16 16"
                            version="1.1"
                            width="16"
                            height="16"
                            aria-hidden="true"
                          >
                            <path
                              fill-rule="evenodd"
                              d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"
                            ></path>
                          </svg>
                        </a>
                        <strong [translate]="'settings.my_subscription'"> My Subscription </strong>
                      </h5>
                    </div>
                    <div class="desc-card-body">
                      <ul class="info-list info-list-lg list-styled text-dark" *ngIf="payment">
                        <li class="info-list-item">
                          <div class="info-list-item-row">
                            <div class="info-list-text info-list-label">
                              <span class="info-list-label-text" [translate]="'settings.plans'">Plans</span>
                            </div>
                            <div class="info-list-text info-list-val">{{ userPlanType }}</div>
                          </div>
                        </li>
                        <ng-container *ngIf="userPlanType !== planType.FREE">
                          <li class="info-list-item">
                            <div class="info-list-text info-list-label" [translate]="'billing_info.billing'">
                              Billing
                            </div>
                            <div class="info-list-text info-list-val">
                              {{ isLifeTimePrime ? 'Lifetime' : payment.payment_type }}
                            </div>
                          </li>
                          <li class="info-list-item">
                            <div class="info-list-text info-list-label" [translate]="'settings.payment'">Payment</div>
                            <div class="info-list-text info-list-val text-capitalize">
                              <span>{{ payment.payment_method }}</span>
                              <i
                                *ngIf="payment?.payment_method === paymentMethod.stripe"
                                class="{{
                                  isCardUpdateMode
                                    ? 'fas fa-chevron-up pr-2 cursor-pointer float-right'
                                    : 'fas fa-chevron-down pr-2 cursor-pointer float-right'
                                }}"
                                (click)="isCardUpdateMode = !isCardUpdateMode"
                              ></i>
                            </div>
                          </li>
                          <li class="info-list-item info-list-detail" *ngIf="isCardUpdateMode">
                            <div class="info-list-text info-list-detail-content col-12" *ngFor="let card of cards">
                              <input
                                class="d-none fancy-field-control fancy-field-control-sm"
                                id="{{ 'card_' + card.last4 }}"
                                name="activeCard"
                                type="radio"
                                (click)="onMakePrimaryCard(card)"
                                [checked]="card.is_primary"
                              />
                              <label for="{{ 'card_' + card.last4 }}">{{ card.last4 | creditcardnumber }}</label>
                              <i
                                *ngIf="!card.is_primary"
                                (click)="onDeleteCard(card)"
                                [ngbTooltip]="'common.delete' | translate"
                                class="fas fa-trash pr-2 cursor-pointer float-right"
                              ></i>
                            </div>
                            <div class="info-list-text info-list-action col-12">
                              <a (click)="onAddNewCard()" [translate]="'settings.add_new_method'">ADD NEW METHOD</a>
                            </div>
                          </li>
                          <li class="info-list-item">
                            <div class="info-list-text info-list-label" [translate]="'settings.billing_cycle_end'">
                              Billing Cycle End
                            </div>
                            <div class="info-list-text info-list-val">
                              <span>{{
                                isLifeTimePrime ? 'Never' : (payment.billing_cycle_ends | momentDate: 'mediumDate')
                              }}</span>
                              <a
                                *ngIf="
                                  !isLifeTimePrime &&
                                  (!settings.recurrence_billing || payment?.payment_method === paymentMethod.bitcoin)
                                "
                                [ngbTooltip]="'settings.extend_billing_cycle' | translate"
                                class="float-right"
                                (click)="renew()"
                                [translate]="'settings.renew'"
                              >
                                Renew
                              </a>
                            </div>
                          </li>
                          <li class="info-list-item">
                            <div class="info-list-text info-list-label" [translate]="'settings.recurring_billing'">
                              Recurring Billing
                            </div>
                            <div class="info-list-text info-list-val">
                              <div
                                class="row row-sm"
                                *ngIf="payment.payment_method === paymentMethod.stripe; else bitcoinMethod"
                              >
                                <div class="col-6 flex-auto-col">
                                  <div class="fancy-field-group">
                                    <input
                                      class="d-none fancy-field-control fancy-field-control-sm"
                                      id="enableRecurringBilling"
                                      name="recurringBilling"
                                      type="radio"
                                      [disabled]="isLifeTimePrime"
                                      (click)="updateSettings('recurrence_billing', true)"
                                      [checked]="settings.recurrence_billing && !isLifeTimePrime"
                                    />
                                    <label for="enableRecurringBilling" [translate]="'common.yes'">Yes</label>
                                  </div>
                                </div>
                                <div class="col-6 flex-auto-col">
                                  <div class="fancy-field-group">
                                    <input
                                      class="d-none fancy-field-control fancy-field-control-sm"
                                      id="disableRecurringBilling"
                                      name="recurringBilling"
                                      type="radio"
                                      [disabled]="isLifeTimePrime"
                                      (click)="updateSettings('recurrence_billing', false)"
                                      [checked]="!settings.recurrence_billing || isLifeTimePrime"
                                    />
                                    <label for="disableRecurringBilling" [translate]="'common.no'">No</label>
                                  </div>
                                </div>
                              </div>
                              <ng-template #bitcoinMethod>
                                <span [translate]="'settings.not_available_for_bitcoin'">
                                  Not available for bitcoin
                                </span>
                              </ng-template>
                            </div>
                          </li>
                        </ng-container>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="col-md-6 mb-4 mb-md-0">
                  <div class="desc-card">
                    <div class="desc-card-header ui-header ui-header-bordered border-all-corner border-bottom-0">
                      <h5 class="ui-header-subtitle text-dark mb-0">
                        <strong [translate]="'settings.bills'">Bills</strong>
                      </h5>
                    </div>
                    <div class="plan-details">
                      <div
                        class="desc-card-body invoices"
                        [ngClass]="{ 'no-invoice': userState?.isInvoiceLoaded && invoices?.length === 0 }"
                      >
                        <div *ngIf="userState?.isInvoiceLoaded && invoices?.length > 0">
                          <ul class="ui-list ui-list-styled list-styled invoices-list">
                            <li class="ui-list-item ui-list-item-xs-full">
                              <div class="row row-xs align-items-center">
                                <div class="col-5 font-weight-bold col-item">
                                  # <span [translate]="'settings.invoice'">Invoice</span>
                                </div>
                                <div class="col-3 col-item">
                                  <div class="form-label mb-0 font-weight-bold" [translate]="'settings.date'">Date</div>
                                </div>
                                <div class="col-2 font-weight-bold col-item" [translate]="'settings.amount'">
                                  Amount
                                </div>
                              </div>
                            </li>

                            <li class="ui-list-item ui-list-item-xs-full" *ngFor="let invoice of invoices">
                              <div class="row row-xs align-items-center">
                                <div
                                  class="col-5 text-dark col-item"
                                  [ngbTooltip]="'settings.view_invoice' | translate"
                                >
                                  <a class="cursor-pointer" (click)="onViewInvoice(invoice)">
                                    {{ invoice.invoice_id }}
                                  </a>
                                </div>
                                <div class="col-3 col-item">
                                  <div class="form-label text-dark mb-0">
                                    {{ invoice.invoice_date | date: 'dd/MM/yyyy' }}
                                  </div>
                                </div>
                                <div class="col-2 text-dark col-item">
                                  ${{ (invoice.total_amount / 100).toFixed(2) }}
                                </div>
                                <div class="col-2 display-inline-flex actions">
                                  <i
                                    (click)="onViewInvoice(invoice)"
                                    [ngbTooltip]="'settings.view' | translate"
                                    class="fas fa-eye pr-2 cursor-pointer"
                                  >
                                  </i>
                                  <i
                                    (click)="onPrintInvoice(invoice)"
                                    [ngbTooltip]="'mail_detail.print' | translate"
                                    class="fas fa-print cursor-pointer"
                                  >
                                  </i>
                                </div>
                              </div>
                            </li>
                          </ul>
                        </div>
                        <div
                          class="no-data"
                          *ngIf="userState?.isInvoiceLoaded && invoices?.length === 0"
                          [translate]="'settings.no_bills_avail'"
                        >
                          No bills available
                        </div>
                        <div class="loader" *ngIf="!userState?.isInvoiceLoaded">
                          <app-loading-spinner [showSpinner]="true"></app-loading-spinner>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>
        <!-- Account Type Section -->
        <section id="account-type" class="mailbox-section" #targetUpgrade>
          <div class="ui-header ui-header-bordered position-relative">
            <h5 class="ui-header-subtitle text-dark mb-0">
              <a class="anchor" aria-hidden="true" (click)="onAnchoredLink('account-type')">
                <svg
                  class="octicon octicon-link"
                  viewBox="0 0 16 16"
                  version="1.1"
                  width="16"
                  height="16"
                  aria-hidden="true"
                >
                  <path
                    fill-rule="evenodd"
                    d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"
                  ></path>
                </svg>
              </a>
              <strong [translate]="'settings.account_type'">Account Type</strong>
            </h5>
          </div>
          <app-pricing-plans
            hideHeader="true"
            blockGapsZero="true"
            [showCurrentPlan]="true"
            [userPlanType]="userPlanType"
            [isLifetimePrime]="isLifeTimePrime"
            [selectedCurrency]="payment.currency"
            [paymentType]="payment.payment_type"
            [paymentMethod]="
              payment.payment_method === 'stripe'
                ? paymentMethod.STRIPE
                : payment.payment_method === 'bitcoin'
                ? paymentMethod.BITCOIN
                : payment.payment_method
            "
            [openBillingInfoInModal]="true"
          >
          </app-pricing-plans>
        </section>
      </ng-template>
    </div>

    <!-- General -->
    <div class="nav" [ngbNavItem]="'general'">
      <a ngbNavLink class="nav-link" [translate]="'settings.general'">General</a>
      <ng-template ngbNavContent>
        <!-- General Settings -->
        <section id="general-settings" class="mailbox-section">
          <header class="ui-header ui-header-bordered">
            <h5 class="ui-header-subtitle text-dark mb-0">
              <a class="anchor" aria-hidden="true" (click)="onAnchoredLink('general-settings')">
                <svg
                  class="octicon octicon-link"
                  viewBox="0 0 16 16"
                  version="1.1"
                  width="16"
                  height="16"
                  aria-hidden="true"
                >
                  <path
                    fill-rule="evenodd"
                    d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"
                  ></path>
                </svg>
              </a>
              <strong [translate]="'settings.general_settings'"> General Settings </strong>
            </h5>
          </header>
          <div class="mailbox-section-body mailbox-section-body-sm">
            <div class="form-content-holder">
              <div class="form-content-row">
                <div class="row align-items-center">
                  <div class="col-sm-3">
                    <label class="form-label mb-0" [translate]="'settings.language'">Language</label>
                  </div>
                  <div class="col-sm-7 col-md-5">
                    <div class="btn-dropdown btn-dropdown-select">
                      <div ngbDropdown class="dropdown-sm" placement="bottom-left">
                        <button ngbDropdownToggle role="button" id="langDropdownMenuButton">
                          {{ selectedLanguage?.name }} ({{ selectedLanguage?.locale }})
                        </button>
                        <div ngbDropdownMenu aria-labelledby="langDropdownMenuButton">
                          <a
                            class="dropdown-item"
                            *ngFor="let language of languages"
                            (click)="updateLanguage(language)"
                          >
                            {{ language.name }} ({{ language.locale }})
                          </a>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="form-content-row">
                <div class="row align-items-center">
                  <div class="col-sm-3">
                    <label class="form-label mb-0" [translate]="'settings.current_time_zone'">
                      Current time zone
                    </label>
                  </div>
                  <div class="col-sm-7 col-md-5">
                    <div class="btn-dropdown btn-dropdown-select">
                      <div ngbDropdown class="dropdown-sm" placement="bottom-left">
                        <button ngbDropdownToggle role="button" id="timezoneDropdownMenuButton">
                          {{ settings.timezone }}
                        </button>
                        <div ngbDropdownMenu aria-labelledby="timezoneDropdownMenuButton" class="timezone-block">
                          <a
                            class="dropdown-item"
                            *ngFor="let timezone of timezones"
                            (click)="updateTimeZone(timezone)"
                          >
                            {{ timezone.value }}
                          </a>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="form-content-row">
                <div class="row align-items-center">
                  <div class="col-sm-3">
                    <label class="form-label mb-0" [translate]="'settings.automatically_save_contact'">
                      Automatically save contacts
                    </label>
                  </div>
                  <div class="col-sm-7 col-md-5">
                    <div class="row row-sm">
                      <div class="col-6 flex-auto-col">
                        <div class="fancy-field-group">
                          <input
                            class="d-none fancy-field-control fancy-field-control-sm"
                            id="autoSaveField1"
                            name="[1]"
                            type="radio"
                            (click)="updateSettings('save_contacts', true)"
                            [checked]="settings.save_contacts"
                          />
                          <label for="autoSaveField1" [translate]="'common.enabled'">Enabled</label>
                        </div>
                      </div>
                      <div class="col-6 flex-auto-col">
                        <div class="fancy-field-group">
                          <input
                            class="d-none fancy-field-control fancy-field-control-sm"
                            id="autoSaveField2"
                            name="[1]"
                            type="radio"
                            (click)="updateSettings('save_contacts', false)"
                            [checked]="!settings.save_contacts"
                          />
                          <label for="autoSaveField2" [translate]="'common.disabled'">Disabled</label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="form-content-row">
                <div class="row align-items-center">
                  <div
                    class="col-sm-3"
                    ngbTooltip="Enabling this option would block all the external images from loading automatically when you open an email"
                  >
                    <label class="form-label mb-0">Block external images</label>
                  </div>
                  <div class="col-sm-7 col-md-5">
                    <div class="row row-sm">
                      <div class="col-6 flex-auto-col">
                        <div class="fancy-field-group">
                          <input
                            class="d-none fancy-field-control fancy-field-control-sm"
                            id="blockExternalImages1"
                            name="[blockExternalImages]"
                            type="radio"
                            (click)="updateSettings('is_disable_loading_images', true)"
                            [checked]="settings.is_disable_loading_images"
                          />
                          <label for="blockExternalImages1" [translate]="'common.enabled'">Enabled</label>
                        </div>
                      </div>
                      <div class="col-6 flex-auto-col">
                        <div class="fancy-field-group">
                          <input
                            class="d-none fancy-field-control fancy-field-control-sm"
                            id="blockExternalImages2"
                            name="[blockExternalImages]"
                            type="radio"
                            (click)="updateSettings('is_disable_loading_images', false)"
                            [checked]="!settings.is_disable_loading_images"
                          />
                          <label for="blockExternalImages2" [translate]="'common.disabled'">Disabled</label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="form-content-row">
                <div class="row align-items-center">
                  <div
                    class="col-sm-3"
                    ngbTooltip="Enabling this option would include original message text when you reply"
                  >
                    <label class="form-label mb-0">Include original message text</label>
                  </div>
                  <div class="col-sm-7 col-md-5">
                    <div class="row row-sm">
                      <div class="col-6 flex-auto-col">
                        <div class="fancy-field-group">
                          <input
                            class="d-none fancy-field-control fancy-field-control-sm"
                            id="includeOriginalMsg1"
                            name="[includeOriginalMsg]"
                            type="radio"
                            (click)="updateSettings('include_original_message', true)"
                            [checked]="settings.include_original_message"
                          />
                          <label for="includeOriginalMsg1" [translate]="'common.enabled'">Enabled</label>
                        </div>
                      </div>
                      <div class="col-6 flex-auto-col">
                        <div class="fancy-field-group">
                          <input
                            class="d-none fancy-field-control fancy-field-control-sm"
                            id="includeOriginalMsg2"
                            name="[includeOriginalMsg]"
                            type="radio"
                            (click)="updateSettings('include_original_message', false)"
                            [checked]="!settings.include_original_message"
                          />
                          <label for="includeOriginalMsg2" [translate]="'common.disabled'">Disabled</label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="form-content-row">
                <div class="row align-items-center">
                  <div class="col-sm-3" ngbTooltip="Help to report bugs automatically by enabling this option">
                    <label class="form-label mb-0">Report bugs</label>
                  </div>
                  <div class="col-sm-7 col-md-5">
                    <div class="row row-sm">
                      <div class="col-6 flex-auto-col">
                        <div class="fancy-field-group">
                          <input
                            class="d-none fancy-field-control fancy-field-control-sm"
                            id="reportBugs1"
                            name="[reportBugs]"
                            type="radio"
                            (click)="updateSettings('is_enable_report_bugs', true)"
                            [checked]="settings.is_enable_report_bugs"
                          />
                          <label for="reportBugs1" [translate]="'common.enabled'">Enabled</label>
                        </div>
                      </div>
                      <div class="col-6 flex-auto-col">
                        <div class="fancy-field-group">
                          <input
                            class="d-none fancy-field-control fancy-field-control-sm"
                            id="reportBugs2"
                            name="[reportBugs]"
                            type="radio"
                            (click)="updateSettings('is_enable_report_bugs', false)"
                            [checked]="!settings.is_enable_report_bugs"
                          />
                          <label for="reportBugs2" [translate]="'common.disabled'">Disabled</label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="form-content-row">
                <div class="row align-items-center">
                  <div class="col-sm-3">
                    <label class="form-label mb-0">Universal Spam Filter</label>
                  </div>
                  <div class="col-sm-7 col-md-5">
                    <div class="row row-sm">
                      <div class="col-6 flex-auto-col">
                        <div class="fancy-field-group">
                          <input
                            class="d-none fancy-field-control fancy-field-control-sm"
                            id="universalSpamFilter1"
                            name="[universalSpamFilter]"
                            type="radio"
                            (click)="updateSettings('universal_spam_filter', true)"
                            [checked]="settings.universal_spam_filter"
                          />
                          <label for="universalSpamFilter1" [translate]="'common.enabled'">Enabled</label>
                        </div>
                      </div>
                      <div class="col-6 flex-auto-col" *ngIf="userPlanType !== planType.FREE">
                        <div class="fancy-field-group">
                          <input
                            class="d-none fancy-field-control fancy-field-control-sm"
                            id="universalSpamFilter2"
                            name="[universalSpamFilter]"
                            type="radio"
                            (click)="updateSettings('universal_spam_filter', false)"
                            [checked]="!settings.universal_spam_filter"
                          />
                          <label for="universalSpamFilter2" [translate]="'common.disabled'">Disabled</label>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="info-card mt-2 mx-3 full-width" *ngIf="userPlanType === planType.FREE">
                    <p [translate]="'settings.upgrade_to_change_spam_filter'">
                      Upgrade to Prime to change the spam filter setting!
                    </p>
                  </div>
                </div>
              </div>
              <div class="form-content-row">
                <div class="row align-items-center">
                  <div class="col-sm-3">
                    <label class="form-label mb-0" [translate]="'mail_detail.show_plain_text'">Show Plain Text</label>
                  </div>
                  <div class="col-sm-7 col-md-5">
                    <div class="row row-sm">
                      <div class="col-6 flex-auto-col">
                        <div class="fancy-field-group">
                          <input
                            class="d-none fancy-field-control fancy-field-control-sm"
                            id="showPlainTextMode1"
                            name="[showPlainTextMode]"
                            type="radio"
                            (click)="updateShowPlainTextMode(true)"
                            [checked]="settings.show_plain_text"
                          />
                          <label for="showPlainTextMode1" [translate]="'common.enabled'">Enabled</label>
                        </div>
                      </div>
                      <div class="col-6 flex-auto-col">
                        <div class="fancy-field-group">
                          <input
                            class="d-none fancy-field-control fancy-field-control-sm"
                            id="showPlainTextMode2"
                            name="[showPlainTextMode]"
                            type="radio"
                            (click)="updateShowPlainTextMode(false)"
                            [checked]="!settings.show_plain_text"
                          />
                          <label for="showPlainTextMode2" [translate]="'common.disabled'">Disabled</label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- Composer Settings -->
        <section id="composer-settings" class="mailbox-section">
          <header class="ui-header ui-header-bordered">
            <h5 class="ui-header-subtitle text-dark mb-0">
              <a class="anchor" aria-hidden="true" (click)="onAnchoredLink('composer-settings')">
                <svg
                  class="octicon octicon-link"
                  viewBox="0 0 16 16"
                  version="1.1"
                  width="16"
                  height="16"
                  aria-hidden="true"
                >
                  <path
                    fill-rule="evenodd"
                    d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"
                  ></path>
                </svg>
              </a>
              <strong [translate]="'settings.composer_settings'"> Composer </strong>
            </h5>
          </header>
          <div class="mailbox-section-body mailbox-section-body-sm">
            <div class="form-content-holder">
              <div class="form-content-row">
                <div class="row align-items-center">
                  <div class="col-sm-3">
                    <label class="form-label mb-0">Default composer size</label>
                  </div>
                  <div class="col-sm-7 col-md-5">
                    <div class="row row-sm">
                      <div class="col-6 flex-auto-col">
                        <div class="fancy-field-group">
                          <input
                            class="d-none fancy-field-control fancy-field-control-sm"
                            id="composersize1"
                            name="[composerSize]"
                            type="radio"
                            (click)="updateSettings('is_composer_full_screen', false)"
                            [checked]="!settings.is_composer_full_screen"
                          />
                          <label for="composersize1">Small pop-up</label>
                        </div>
                      </div>
                      <div class="col-6 flex-auto-col">
                        <div class="fancy-field-group">
                          <input
                            class="d-none fancy-field-control fancy-field-control-sm"
                            id="composersize2"
                            name="[composerSize]"
                            type="radio"
                            (click)="updateSettings('is_composer_full_screen', true)"
                            [checked]="settings.is_composer_full_screen"
                          />
                          <label for="composersize2">Full screen</label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="form-content-row">
                <div class="row align-items-center">
                  <div class="col-sm-3">
                    <label class="form-label mb-0" [translate]="'settings.compose_font'">
                      Default composing font
                    </label>
                  </div>
                  <div class="col-sm-7 col-md-5">
                    <div class="btn-dropdown btn-dropdown-select">
                      <div ngbDropdown class="dropdown-sm" placement="bottom-left">
                        <button
                          ngbDropdownToggle
                          class="text-capitalize"
                          role="button"
                          id="defaultFontDropdownMenuButton"
                          [ngStyle]="{ 'font-family': settings.default_font }"
                        >
                          {{ settings.default_font }}
                        </button>
                        <div ngbDropdownMenu aria-labelledby="defaultFontDropdownMenuButton">
                          <a
                            class="dropdown-item text-capitalize"
                            *ngFor="let font of fonts"
                            (click)="updateSettings('default_font', font)"
                            [ngStyle]="{ 'font-family': font }"
                          >
                            {{ font }}
                          </a>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="form-content-row">
                <div class="row align-items-center">
                  <div class="col-sm-3">
                    <label class="form-label mb-0" [translate]="'settings.compose_color'">
                      Default composing color
                    </label>
                  </div>
                  <div class="col-sm-7 col-md-5">
                    <div class="btn-dropdown btn-dropdown-select">
                      <div ngbDropdown class="dropdown-sm" placement="bottom-left">
                        <button
                          ngbDropdownToggle
                          class="text-capitalize"
                          role="button"
                          id="defaultColorDropdownMenuButton"
                        >
                          <span *ngIf="settings.default_color; else notDefaultColor">
                            <i class="color-box" [style.background]="settings.default_color"></i>
                            {{ settings.default_color }}
                          </span>
                          <ng-template #notDefaultColor>
                            <i class="color-box" [style.background]="colors[0]"></i>
                            <span> {{ colors[0] }} </span>
                          </ng-template>
                        </button>
                        <div ngbDropdownMenu aria-labelledby="defaultColorDropdownMenuButton">
                          <a
                            class="dropdown-item text-capitalize"
                            *ngFor="let color of colors"
                            (click)="updateSettings('default_color', color)"
                          >
                            <i class="color-box" [style.background]="color"></i>
                            <span class="text-capitalize">
                              {{ color }}
                            </span>
                          </a>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="form-content-row">
                <div class="row align-items-center">
                  <div class="col-sm-3">
                    <label class="form-label mb-0" [translate]="'settings.compose_background'">
                      Default composing background
                    </label>
                  </div>
                  <div class="col-sm-7 col-md-5">
                    <div class="btn-dropdown btn-dropdown-select">
                      <div ngbDropdown class="dropdown-sm" placement="bottom-left">
                        <button
                          ngbDropdownToggle
                          class="text-capitalize"
                          role="button"
                          id="defaultBackgroundDropdownMenuButton"
                        >
                          <span *ngIf="settings.default_background; else notDefaultBackground">
                            <i class="color-box" [style.background]="settings.default_background"></i>
                            {{ settings.default_background }}
                          </span>
                          <ng-template #notDefaultBackground>
                            <i class="color-box" [style.background]="backgrounds[0]"></i>
                            <span> {{ backgrounds[0] }} </span>
                          </ng-template>
                        </button>
                        <div ngbDropdownMenu aria-labelledby="defaultBackgroundDropdownMenuButton">
                          <a
                            class="dropdown-item text-capitalize"
                            *ngFor="let background of backgrounds"
                            (click)="updateSettings('default_background', background)"
                          >
                            <i class="color-box" [style.background]="background"></i>
                            <span class="text-capitalize">
                              {{ background }}
                            </span>
                          </a>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="form-content-row">
                <div class="row align-items-center">
                  <div class="col-sm-3">
                    <label class="form-label mb-0" [translate]="'settings.compose_size'">
                      Default composing size
                    </label>
                  </div>
                  <div class="col-sm-7 col-md-5">
                    <div class="btn-dropdown btn-dropdown-select">
                      <div ngbDropdown class="dropdown-sm" placement="bottom-left">
                        <button
                          ngbDropdownToggle
                          class="text-capitalize"
                          role="button"
                          id="defaultSizeDropdownMenuButton"
                        >
                          <span
                            *ngIf="
                              settings.default_size && settings.default_size !== defaultFontSize;
                              else displayDefault
                            "
                          >
                            {{ settings.default_size }}px
                          </span>
                          <ng-template #displayDefault>
                            <span> {{ defaultFontSize }}px (default) </span>
                          </ng-template>
                        </button>
                        <div ngbDropdownMenu aria-labelledby="defaultSizeDropdownMenuButton">
                          <a
                            class="dropdown-item text-capitalize"
                            *ngFor="let size of sizes"
                            (click)="updateSettings('default_size', size)"
                          >
                            <span *ngIf="size !== defaultFontSize; else setDefault"> {{ size }}px </span>
                            <ng-template #setDefault>
                              <span> {{ size }}px (default) </span>
                            </ng-template>
                          </a>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="form-content-row">
                <div class="row align-items-center">
                  <div class="col-sm-3">
                    <label class="form-label mb-0" [translate]="'settings.compose_autosave_duration'">
                      Composing autosave interval
                    </label>
                  </div>
                  <div class="col-sm-7 col-md-5">
                    <div class="btn-dropdown btn-dropdown-select">
                      <div ngbDropdown class="dropdown-sm" placement="bottom-left">
                        <button
                          ngbDropdownToggle
                          class="text-capitalize"
                          role="button"
                          id="defaultAutosaveDropdownMenuButton"
                        >
                          {{ autosave_duration }}
                        </button>
                        <div ngbDropdownMenu aria-labelledby="defaultAutosaveDropdownMenuButton">
                          <a
                            class="dropdown-item text-capitalize"
                            *ngFor="let duration of autosave_duration_list"
                            (click)="updateSettings('autosave_duration', duration)"
                          >
                            {{ duration }}
                          </a>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="form-content-row">
                <div class="row align-items-center">
                  <div class="col-sm-3">
                    <label class="form-label mb-0" [translate]="'settings.html_editor'">HTML editor</label>
                  </div>
                  <div class="col-sm-7 col-md-5">
                    <div class="row row-sm">
                      <div class="col-6 flex-auto-col">
                        <div class="fancy-field-group">
                          <input
                            class="d-none fancy-field-control fancy-field-control-sm"
                            id="htmlEditor1"
                            name="[htmlEditor]"
                            type="radio"
                            (click)="updateSettings('is_html_disabled', false)"
                            [checked]="!settings.is_html_disabled"
                          />
                          <label for="htmlEditor1" [translate]="'common.enabled'">Enabled</label>
                        </div>
                      </div>
                      <div class="col-6 flex-auto-col">
                        <div class="fancy-field-group">
                          <input
                            class="d-none fancy-field-control fancy-field-control-sm"
                            id="htmlEditor2"
                            name="[htmlEditor]"
                            type="radio"
                            (click)="updateSettings('is_html_disabled', true)"
                            [checked]="settings.is_html_disabled"
                          />
                          <label for="htmlEditor2" [translate]="'common.disabled'">Disabled</label>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="info-card mt-2 mx-3 full-width">
                    <p [translate]="'settings.disabling_editor_message'">
                      Disable the HTML editor if you want to send emails in plain text.
                    </p>
                  </div>
                </div>
              </div>
              <div class="form-content-row">
                <div class="row align-items-center">
                  <div class="col-sm-3">
                    <label class="form-label mb-0" [translate]="'settings.plain_text_hard_wrap'"
                      >Plain text hard wrap</label
                    >
                  </div>
                  <div class="col-sm-7 col-md-5">
                    <div class="row row-sm">
                      <div class="col-6 flex-auto-col">
                        <div class="fancy-field-group">
                          <input
                            class="d-none fancy-field-control fancy-field-control-sm"
                            id="hardWrapMode1"
                            name="[hardWrapMode]"
                            type="radio"
                            (click)="updateSettings('is_hard_wrap', true)"
                            [checked]="settings.is_hard_wrap"
                          />
                          <label for="hardWrapMode1" [translate]="'common.enabled'">Enabled</label>
                        </div>
                      </div>
                      <div class="col-6 flex-auto-col">
                        <div class="fancy-field-group">
                          <input
                            class="d-none fancy-field-control fancy-field-control-sm"
                            id="hardWrapMode2"
                            name="[hardWrapMode]"
                            type="radio"
                            (click)="updateSettings('is_hard_wrap', false)"
                            [checked]="!settings.is_hard_wrap"
                          />
                          <label for="hardWrapMode2" [translate]="'common.disabled'">Disabled</label>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="info-card mt-2 mx-3 full-width">
                    <p [translate]="'settings.plain_text_hard_wrap_desc'">
                      Email contents will be hard wrapped when you send plain text email.
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- Appreance Section -->
        <section id="appearance" class="mailbox-section">
          <header class="ui-header ui-header-bordered">
            <h5 class="ui-header-subtitle text-dark mb-0">
              <a class="anchor" aria-hidden="true" (click)="onAnchoredLink('appearance')">
                <svg
                  class="octicon octicon-link"
                  viewBox="0 0 16 16"
                  version="1.1"
                  width="16"
                  height="16"
                  aria-hidden="true"
                >
                  <path
                    fill-rule="evenodd"
                    d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"
                  ></path>
                </svg>
              </a>
              <strong [translate]="'settings.appearance'">Appearance</strong>
            </h5>
          </header>
          <div class="mailbox-section-body mailbox-section-body-sm">
            <div class="form-content-holder">
              <div class="form-content-row">
                <div class="row align-items-center">
                  <div class="col-sm-3">
                    <label class="form-label mb-sm-0" [translate]="'settings.emails_per_page'"> Emails per page </label>
                  </div>
                  <div class="col-sm-7 col-md-5">
                    <div class="row row-sm">
                      <div class="col-6 flex-auto-col">
                        <div class="fancy-field-group">
                          <input
                            class="d-none fancy-field-control fancy-field-control-sm"
                            id="emailCoutField1"
                            name="[5]"
                            type="radio"
                            (click)="updateSettings('emails_per_page', 20)"
                            [checked]="settings?.emails_per_page === 20"
                          />
                          <label for="emailCoutField1">20</label>
                        </div>
                      </div>
                      <div class="col-6 flex-auto-col">
                        <div class="fancy-field-group">
                          <input
                            class="d-none fancy-field-control fancy-field-control-sm"
                            id="emailCoutField2"
                            name="[5]"
                            type="radio"
                            (click)="updateSettings('emails_per_page', 50)"
                            [checked]="settings?.emails_per_page === 50"
                          />
                          <label for="emailCoutField2">50</label>
                        </div>
                      </div>
                      <div class="col-6 flex-auto-col">
                        <div class="fancy-field-group">
                          <input
                            class="d-none fancy-field-control fancy-field-control-sm"
                            id="emailCoutField3"
                            name="[5]"
                            type="radio"
                            (click)="updateSettings('emails_per_page', 100)"
                            [checked]="settings?.emails_per_page === 100"
                          />
                          <label for="emailCoutField3">100</label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="form-content-row">
                <div class="row align-items-center">
                  <div class="col-sm-3">
                    <label class="form-label mb-0">Dark mode</label>
                  </div>
                  <div class="col-sm-7 col-md-5">
                    <div class="row row-sm">
                      <div class="col-6 flex-auto-col">
                        <div class="fancy-field-group">
                          <input
                            class="d-none fancy-field-control fancy-field-control-sm"
                            id="darkMode1"
                            name="[darkMode]"
                            type="radio"
                            (click)="onSetDarkMode(true)"
                            [checked]="settings.is_night_mode"
                          />
                          <label for="darkMode1" [translate]="'common.enabled'">Enabled</label>
                        </div>
                      </div>
                      <div class="col-6 flex-auto-col">
                        <div class="fancy-field-group">
                          <input
                            class="d-none fancy-field-control fancy-field-control-sm"
                            id="darkMode2"
                            name="[darkMode]"
                            type="radio"
                            (click)="onSetDarkMode(false)"
                            [checked]="!settings.is_night_mode"
                          />
                          <label for="darkMode2" [translate]="'common.disabled'">Disabled</label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="form-content-row">
                <div class="row align-items-center">
                  <div class="col-sm-3">
                    <label class="form-label mb-0">Conversation View</label>
                  </div>
                  <div class="col-sm-7 col-md-5">
                    <div class="row row-sm">
                      <div class="col-6 flex-auto-col">
                        <div class="fancy-field-group">
                          <input
                            class="d-none fancy-field-control fancy-field-control-sm"
                            id="conversationViewMode1"
                            name="[conversationMode]"
                            type="radio"
                            (click)="updateConversationMode(true)"
                            [checked]="settings.is_conversation_mode"
                          />
                          <label for="conversationViewMode1" [translate]="'common.enabled'">Enabled</label>
                        </div>
                      </div>
                      <div class="col-6 flex-auto-col">
                        <div class="fancy-field-group">
                          <input
                            class="d-none fancy-field-control fancy-field-control-sm"
                            id="conversationViewMode2"
                            name="[conversationMode]"
                            type="radio"
                            (click)="updateConversationMode(false)"
                            [checked]="!settings.is_conversation_mode"
                          />
                          <label for="conversationViewMode2" [translate]="'common.disabled'">Disabled</label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="form-content-row">
                <div class="row align-items-center">
                  <div class="col-sm-3">
                    <label class="form-label mb-0" [translate]="'settings.plain_text_font'">
                      Default plain text font
                    </label>
                  </div>
                  <div class="col-sm-7 col-md-5">
                    <div class="btn-dropdown btn-dropdown-select">
                      <div ngbDropdown class="dropdown-sm">
                        <button
                          ngbDropdownToggle
                          class="text-capitalize"
                          role="button"
                          id="defaultFontDropdownMenuButton"
                          [ngStyle]="{ 'font-family': settings.plain_text_font }"
                        >
                          {{ settings.plain_text_font }}
                        </button>
                        <div ngbDropdownMenu aria-labelledby="defaultFontDropdownMenuButton">
                          <a
                            class="dropdown-item text-capitalize"
                            *ngFor="let font of fonts"
                            (click)="updateSettings('plain_text_font', font)"
                            [ngStyle]="{ 'font-family': font }"
                          >
                            {{ font }}
                          </a>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="form-content-row">
                <div class="row align-items-center">
                  <div class="col-sm-3">
                    <label for="customCss" class="form-label mb-sm-0"> Themes </label>
                  </div>
                  <div class="col-sm-7 col-md-5">
                    <div class="btn-dropdown btn-dropdown-select">
                      <div ngbDropdown class="dropdown-sm">
                        <button
                          ngbDropdownToggle
                          class="text-capitalize"
                          role="button"
                          id="customThemeDropdownMenuButton"
                        >
                          {{ selectedThemeName || 'Please select theme' }}
                        </button>
                        <div ngbDropdownMenu aria-labelledby="defaultFontDropdownMenuButton">
                          <a
                            class="dropdown-item text-capitalize"
                            *ngFor="let theme of themes"
                            (click)="onSelectCustomTheme(theme)"
                          >
                            {{ theme.name }}
                          </a>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- <div class="form-content-row">
                <div class="row align-items-center">
                  <div class="col-sm-3">
                    <label for="customCss" class="form-label mb-sm-0"> Customize CSS </label>
                  </div>
                  <form class="col-sm-7 col-md-5" autocomplete="off">
                    <textarea
                      class="form-control"
                      id="customCss"
                      name="customCss"
                      [(ngModel)]="settings.custom_css"
                      [ngModelOptions]="{ updateOn: 'blur' }"
                      (change)="updateSettings('custom_css', $event.target?.value)"
                      rows="6"
                    >
                    </textarea>
                  </form>
                  <div class="info-card mx-3 mt-2 full-width">
                    <p>
                      You can write your own CSS here in order to customize the display of your mailbox.
                      <br />
                      There are official themes under development.
                      <a href="https://github.com/CTemplar/webclient-themes" target="_blank" rel="noopener noreferrer"
                        >Check them here!</a
                      >
                    </p>
                  </div>
                </div>
              </div> -->
            </div>
          </div>
        </section>

        <!-- Notification Section -->
        <section id="notification" class="mailbox-section">
          <header class="ui-header ui-header-bordered">
            <h5 class="ui-header-subtitle text-dark mb-0">
              <a class="anchor" aria-hidden="true" (click)="onAnchoredLink('notification')">
                <svg
                  class="octicon octicon-link"
                  viewBox="0 0 16 16"
                  version="1.1"
                  width="16"
                  height="16"
                  aria-hidden="true"
                >
                  <path
                    fill-rule="evenodd"
                    d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"
                  ></path>
                </svg>
              </a>
              <strong [translate]="'settings.notifications'">Notifications</strong>
            </h5>
          </header>
          <div class="mailbox-section-body mailbox-section-body-sm">
            <div class="form-content-holder">
              <div class="form-content-row">
                <div class="row align-items-center">
                  <div class="col-sm-3">
                    <label
                      for="notificationEmail"
                      class="form-label mb-sm-0"
                      [translate]="'settings.notification_email'"
                    >
                      Notification email
                    </label>
                  </div>
                  <form class="col-sm-7 col-md-5" autocomplete="off">
                    <input
                      class="form-control form-control-sm"
                      id="notificationEmail"
                      type="email"
                      name="notificationEmail"
                      autocomplete="off"
                      [(ngModel)]="notificationEmail"
                      [ngModelOptions]="{ updateOn: 'blur' }"
                      (change)="updateSettings('notification_email', $event.target?.value)"
                      placeholder="notify@example.com"
                      onfocus="(this.placeholder='')"
                      onfocusout="(this.placeholder='notify@example.com')"
                    />
                  </form>
                  <div class="info-card mx-3 mt-2 full-width">
                    <p [translate]="'settings.enter_notification_email'">
                      Enter a notification email on which you would like to receive notification each day when you have
                      new emails.
                    </p>
                  </div>
                </div>
                <div class="row align-items-center">
                  <div class="col-sm-3">
                    <label class="form-label mb-sm-0" [translate]="'settings.desktop_notification_title'">
                      Desktop notifications
                    </label>
                  </div>
                  <div class="col-sm-7 col-md-5">
                    <div class="info-card mt-3 full-width">
                      <p
                        *ngIf="notificationsPermission === notificationPermissionType.DENIED"
                        [translate]="'settings.desktop_notifications_dis'"
                      >
                        Desktop Notifications are disabled. Please go to your browser settings in order to enable them.
                      </p>
                      <p *ngIf="notificationsPermission === notificationPermissionType.DEFAULT">
                        <a (click)="requestNotificationPermission()" [translate]="'settings.click_here'">
                          Click here
                        </a>
                        <span translate="settings.enable_notifications">
                          in order to enable desktop notifications.
                        </span>
                      </p>
                      <p *ngIf="notificationsPermission === notificationPermissionType.GRANTED">
                        <span [translate]="'settings.desktop_notifications_en'">
                          Desktop notifications are enabled.
                        </span>
                        <a (click)="testNotification()">
                          <span [translate]="'settings.click_to_test'">Click here to test</span>
                        </a>
                      </p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- Notification Section Ends -->

        <!-- Referral Code Section -->
        <section id="referral-code" class="mailbox-section">
          <header class="ui-header ui-header-bordered">
            <h5 class="ui-header-subtitle text-dark mb-0">
              <a class="anchor" aria-hidden="true" (click)="onAnchoredLink('referral-code')">
                <svg
                  class="octicon octicon-link"
                  viewBox="0 0 16 16"
                  version="1.1"
                  width="16"
                  height="16"
                  aria-hidden="true"
                >
                  <path
                    fill-rule="evenodd"
                    d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"
                  ></path>
                </svg>
              </a>
              <strong [translate]="'settings.referral_code'">Referral Code</strong>
            </h5>
          </header>
          <div class="mailbox-section-body mailbox-section-body-sm">
            <div class="form-content-holder">
              <span>{{ userState.settings.referral_code }}</span>
              <button mat-icon-button (click)="copyToClipboard(userState.settings.referral_code)" class="copy-btn">
                <i class="fas fa-copy font-20px" ngbTooltip="Copy to clipboard"></i>
              </button>
            </div>
            <div class="info-card mt-2 full-width">
              <p [translate]="'settings.get_one_month_prime_membership'">
                Get one month of Prime membership free for every Prime sign up made using your referral code.
              </p>
            </div>
          </div>
        </section>
        <!-- Referral Code Section Ends -->

        <section id="invitation-codes" class="mailbox-section">
          <app-invite-codes (onAnchored)="onAnchoredLink('invitation-codes')"></app-invite-codes>
        </section>

        <!-- Delete account settings -->
        <section id="delete-account" class="mailbox-section">
          <header class="ui-header ui-header-bordered">
            <h5 class="ui-header-subtitle text-dark mb-0">
              <a class="anchor" aria-hidden="true" (click)="onAnchoredLink('delete-account')">
                <svg
                  class="octicon octicon-link"
                  viewBox="0 0 16 16"
                  version="1.1"
                  width="16"
                  height="16"
                  aria-hidden="true"
                >
                  <path
                    fill-rule="evenodd"
                    d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"
                  ></path>
                </svg>
              </a>
              <strong [translate]="'settings.delete_account'"> Delete Account </strong>
            </h5>
          </header>
          <div class="mailbox-section-body mailbox-section-body-sm">
            <div class="form-content-holder">
              <app-loading-spinner [showSpinner]="authState?.inProgress"></app-loading-spinner>
              <div class="info-card">
                <p [translate]="'settings.delete_account_guide'">
                  If you permanently delete your account you will lose all the data in your mailbox. In 12 months this
                  username will be available for re-use by anyone who selects it.
                </p>
                <button
                  type="button"
                  class="text-uppercase btn-link"
                  role="button"
                  [disabled]="authState?.inProgress"
                  (click)="onDeleteAccount()"
                >
                  <strong>
                    <u [translate]="'settings.delete_account_perm'">Permanently Delete Account</u>
                  </strong>
                </button>
              </div>
            </div>
          </div>
        </section>
      </ng-template>
    </div>

    <!-- Filters and blocked addresses -->
    <div class="nav" [ngbNavItem]="'filters-and-blocked-addresses'">
      <a ngbNavLink class="nav-link" [translate]="'settings.filters.title'">Filters & Blocked Addresses</a>
      <ng-template ngbNavContent>
        <!-- Custom filters -->
        <app-mail-filters id="filters" (onAnchored)="onAnchoredLink('filters')"></app-mail-filters>

        <!-- Whitelist settings -->
        <section id="whitelist" class="mailbox-section">
          <header class="ui-header ui-header-bordered whitelist-header">
            <h5 class="ui-header-subtitle text-dark mb-0">
              <a class="anchor" aria-hidden="true" (click)="onAnchoredLink('whitelist')">
                <svg
                  class="octicon octicon-link"
                  viewBox="0 0 16 16"
                  version="1.1"
                  width="16"
                  height="16"
                  aria-hidden="true"
                >
                  <path
                    fill-rule="evenodd"
                    d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"
                  ></path>
                </svg>
              </a>
              <strong [translate]="'settings.whitelist.name'">Whitelist</strong>
            </h5>
            <a
              href="javascript:void(0);"
              class="text-uppercase btn-link"
              role="button"
              (click)="newListContact = { show: true, type: 'Whitelist' }"
            >
              <strong>
                <u [translate]="'settings.whitelist.add_whitelist_contact'"> Add whitelist contact </u>
              </strong>
            </a>
          </header>
          <div class="mailbox-section-body mailbox-section-body-sm">
            <div class="form-content-holder">
              <div class="col-sm-6 mailbox-navbar-col">
                <div class="form search-form">
                  <div>
                    <div class="form-group mb-0 position-relative">
                      <input
                        class="form-control form-control-sm"
                        type="text"
                        [formControl]="searchWhitelistInput"
                        (keyup.enter)="searchWhitelist()"
                        [placeholder]="searchWhitelistPlaceholder | translate"
                      />
                      <button
                        class="clear-btn"
                        *ngIf="searchWhitelistInput.value?.length > 0"
                        (click)="searchWhitelistInput.setValue('')"
                      >
                        <i class="fas fa-times"></i>
                      </button>
                      <button class="btn btn-sm btn-secondary search-btn" (click)="searchWhitelist()" role="button">
                        <i class="icon icon-search"></i>
                      </button>
                    </div>
                  </div>
                </div>
              </div>
              <ul class="ui-list ui-list-styled list-styled whitelist-list">
                <li class="ui-list-item ui-list-item-xs-full" *ngFor="let item of WhitelistItems">
                  <div class="row row-xs align-items-center">
                    <div class="col-10 col-sm-8">
                      <div class="form-label text-dark mb-0">{{ item.email }}</div>
                    </div>
                    <div class="col-2 col-sm-4">
                      <ul
                        class="
                          setting-actions-list
                          d-flex
                          align-items-center
                          justify-content-end
                          list-styled
                          text-right
                        "
                      >
                        <li>
                          <a (click)="moveToBlacklist(item.id, item.name, item.email)" role="button">
                            <i class="fas fa-ban" ngbTooltip="Move to Blacklist"></i>
                          </a>
                        </li>
                        <li>
                          <a (click)="deleteWhiteList(item.id)" role="button">
                            <i class="icon icon-garbage"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </li>
              </ul>
              <div class="info-card">
                <p [innerHTML]="'settings.whitelist.info' | translate">
                  Messages from contacts in the whitelist always go to <strong>Inbox folder</strong>. Marking a message
                  as not spam adds the address to the Whitelist.
                </p>
              </div>
            </div>
          </div>
        </section>

        <!-- Blacklist settings -->
        <section id="blacklist" class="mailbox-section">
          <header class="ui-header ui-header-bordered blacklist-header">
            <h5 class="ui-header-subtitle text-dark mb-0">
              <a class="anchor" aria-hidden="true" (click)="onAnchoredLink('blacklist')">
                <svg
                  class="octicon octicon-link"
                  viewBox="0 0 16 16"
                  version="1.1"
                  width="16"
                  height="16"
                  aria-hidden="true"
                >
                  <path
                    fill-rule="evenodd"
                    d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"
                  ></path>
                </svg>
              </a>
              <strong [translate]="'settings.blacklist.name'">Blacklist</strong>
            </h5>
            <a
              href="javascript:void(0);"
              class="text-uppercase btn-link"
              role="button"
              (click)="newListContact = { show: true, type: 'Blacklist' }"
            >
              <strong>
                <u [translate]="'settings.blacklist.add_blacklist_contact'"> Add blacklist contact </u>
              </strong>
            </a>
          </header>
          <div class="mailbox-section-body mailbox-section-body-sm">
            <div class="form-content-holder">
              <div class="col-sm-6 mailbox-navbar-col">
                <div class="form search-form">
                  <div>
                    <div class="form-group mb-0 position-relative">
                      <input
                        class="form-control form-control-sm"
                        type="text"
                        [formControl]="searchBlacklistInput"
                        (keyup.enter)="searchBlacklist()"
                        [placeholder]="searchBlacklistPlaceholder | translate"
                      />
                      <button
                        class="clear-btn"
                        *ngIf="searchBlacklistInput.value?.length > 0"
                        (click)="searchBlacklistInput.setValue('')"
                      >
                        <i class="fas fa-times"></i>
                      </button>
                      <button class="btn btn-sm btn-secondary search-btn" (click)="searchBlacklist()" role="button">
                        <i class="icon icon-search"></i>
                      </button>
                    </div>
                  </div>
                </div>
              </div>
              <ul class="ui-list ui-list-styled list-styled blacklist-list">
                <li class="ui-list-item ui-list-item-xs-full" *ngFor="let item of BlacklistItems">
                  <div class="row row-xs align-items-center">
                    <div class="col-10 col-sm-8">
                      <div class="form-label text-dark mb-0">{{ item.email }}</div>
                    </div>
                    <div class="col-2 col-sm-4">
                      <ul
                        class="
                          setting-actions-list
                          d-flex
                          align-items-center
                          justify-content-end
                          list-styled
                          text-right
                        "
                      >
                        <li>
                          <a (click)="moveToWhitelist(item.id, item.name, item.email)" role="button">
                            <i class="fas fa-user-circle" ngbTooltip="Move to Whitelist"></i>
                          </a>
                        </li>
                        <li>
                          <a (click)="deleteBlackList(item.id)" role="button">
                            <i class="icon icon-garbage"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </li>
              </ul>
              <div class="info-card">
                <p [innerHTML]="'settings.blacklist.info' | translate">
                  Messages from contacts in the blacklist always go to <strong>Spam folder</strong>. Marking a message
                  as spam adds the address to the Blacklist.
                </p>
              </div>
            </div>
          </div>
        </section>
      </ng-template>
    </div>

    <!-- Addresses and Signatures -->
    <div class="nav" [ngbNavItem]="'addresses-and-signatures'">
      <a ngbNavLink class="nav-link" [translate]="'settings.signs_and_aliases'">Signatures & Aliases</a>
      <ng-template ngbNavContent>
        <app-addresses-signature (onAnchored)="onAnchoredLink($event)"></app-addresses-signature>
      </ng-template>
    </div>

    <!-- Folders -->
    <div class="nav" [ngbNavItem]="'folders'">
      <a ngbNavLink class="nav-link" [translate]="'page_pricing.folders'">Folders</a>
      <ng-template ngbNavContent>
        <app-folders (onAnchored)="onAnchoredLink($event)"></app-folders>
      </ng-template>
    </div>

    <!-- Security -->
    <div class="nav" [ngbNavItem]="'security'">
      <a ngbNavLink class="nav-link" [translate]="'home_header.security'">Security</a>
      <ng-template ngbNavContent>
        <app-settings-security (onAnchored)="onAnchoredLink($event)"></app-settings-security>
      </ng-template>
    </div>

    <!-- Domains -->
    <div class="nav" [ngbNavItem]="'domains-and-users'">
      <a ngbNavLink class="nav-link" [translate]="'settings.domains_and_users.title'">Domains & Users</a>
      <ng-template ngbNavContent>
        <app-custom-domains
          (onGotoTab)="navSet.select($event)"
          (onAnchored)="onAnchoredLink($event)"
        ></app-custom-domains>
      </ng-template>
    </div>

    <!-- Forwarding and auto responder -->
    <div class="nav" [ngbNavItem]="'forwarding-and-auto-responder'">
      <a ngbNavLink class="nav-link" [translate]="'settings.forwarding_and_autores'">Forwarding & Autoresponder</a>
      <ng-template ngbNavContent>
        <app-mail-forwarding (onAnchored)="onAnchoredLink($event)"></app-mail-forwarding>
        <app-mail-autoresponder (onAnchored)="onAnchoredLink($event)"></app-mail-autoresponder>
      </ng-template>
    </div>
  </div>
  <div [ngbNavOutlet]="navSet"></div>
  <app-mail-footer></app-mail-footer>
</div>

<!-- Modal groups -->
<app-save-list-contact
  *ngIf="newListContact.show"
  [contactType]="newListContact.type"
  (closed)="newListContact.show = false"
>
</app-save-list-contact>

<!-- Delete account info modal -->
<ng-template #deleteAccountInfoModal let-c="close" let-d="dismiss">
  <div class="modal-header justify-content-sm-center align-items-center text-sm-center">
    <h3 class="modal-title w-100 text-dark">
      <strong [translate]="'settings.delete_account_perm'"> Permanently Delete Account </strong>
    </h3>
    <button type="button" class="close" data-dismiss="modal" aria-label="Close" (click)="d()">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <form [formGroup]="deleteAccountInfoForm" (submit)="onDeleteAccountInfoSubmit()">
    <div class="modal-body bg-faded">
      <div class="text-holder text-dark text-medium">
        <p class="text-danger" [translate]="'settings.delete_account_guide'">
          You have selected to permanently delete your account. If you proceed you will lose all the data in your
          mailbox.In 2 months this username will be available for re-use by anyone who selects it.
        </p>
        <p [translate]="'settings.provide_email'">Please provide an email address in case we need to contact you.</p>
        <div class="login-content-holder mx-auto mt-2 pt-sm-2">
          <div class="form">
            <div class="form-group form-group-sm">
              <label for="deleteAccountEmail" class="d-block text-muted text-left hidden-sm-up"> Email </label>
              <input
                class="form-control text-dark"
                id="deleteAccountEmail"
                autocomplete="off"
                [placeholder]="'common.email' | translate"
                type="email"
                name="deleteAccountEmail"
                formControlName="contact_email"
              />
              <span
                *ngIf="deleteAccountInfoForm.controls['contact_email'].errors && deleteAccountOptions.showErrors"
                class="validate-message"
                [translate]="'settings.email_invalid'"
              >
                The email is invalid.
              </span>
            </div>
            <div class="form-group form-group-sm">
              <label for="deleteAccountPassword" class="d-block text-muted text-left hidden-sm-up">
                Current Password
              </label>
              <div class="input-group">
                <input
                  #deleteAccountPasswordInput
                  class="form-control form-control-lg"
                  id="deleteAccountPassword"
                  autocomplete="new-password"
                  name="deleteAccountPassword"
                  formControlName="password"
                  [placeholder]="'settings.current_password' | translate"
                  type="password"
                />
                <span
                  class="input-group-addon password-toggle bg-white text-muted"
                  (click)="togglePassword(deleteAccountPasswordInput)"
                >
                  <i class="fa fa-eye"></i>
                </span>
              </div>
              <span
                *ngIf="deleteAccountInfoForm.controls['password'].errors && deleteAccountOptions.showErrors"
                class="validate-message"
              >
                <span
                  *ngIf="deleteAccountInfoForm.controls['password'].errors.required"
                  [translate]="'settings.password_req'"
                >
                  Your current password is required.
                </span>
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="modal-footer justify-content-center justify-content-sm-end">
      <button class="btn btn-default btn-sm" type="reset" (click)="d()">
        <span [translate]="'common.cancel'">Cancel</span>
      </button>
      <button class="btn btn-danger btn-sm" type="submit" [translate]="'common.delete'">Delete</button>
    </div>
  </form> </ng-template
><!-- /. Delete account info modal ends -->

<!-- Confirm delete account modal -->
<ng-template #confirmDeleteAccountModal let-c="close" let-d="dismiss">
  <div class="modal-header">
    <h3 class="modal-title w-100 text-dark">
      <strong [translate]="'settings.permanently_delete'"> Confirm Permanently Account Delete </strong>
    </h3>
    <button type="button" class="close" data-dismiss="modal" aria-label="Close" (click)="d()">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body bg-faded">
    <div class="text-holder text-dark text-medium">
      <p [translate]="'settings.permanently_delete_alert'">
        Are you sure you want to permanently delete your account? No one will be able to undo this.
      </p>
    </div>
  </div>
  <div class="modal-footer justify-content-center justify-content-sm-end">
    <button (click)="d()" class="btn btn-default btn-sm" role="button" [translate]="'common.cancel'">Cancel</button>
    <button (click)="confirmDeleteAccount()" class="btn btn-danger btn-sm" role="button" [translate]="'common.delete'">
      Delete
    </button>
  </div> </ng-template
><!-- /.Confirm delete account modal ends -->

<!-- billing info modal -->
<ng-template #billingInfoModal let-c="close" let-d="dismiss">
  <div class="billing-header">
    <button type="button" class="close" data-dismiss="modal" aria-label="Close" (click)="d()">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body user-billing-upgrade-modal bg-faded px-3 py-0 bg-white">
    <app-users-billing-info
      [isUpgradeAccount]="true"
      [isRenew]="true"
      [isAddNewCard]="isAddNewCard"
      [planType]="userPlanType"
      [paymentType]="payment.payment_type"
      [currency]="payment.currency"
      [paymentMethod]="
        payment.payment_method === 'stripe'
          ? paymentMethod.STRIPE
          : payment.payment_method === 'bitcoin'
          ? paymentMethod.BITCOIN
          : payment.payment_method
      "
      (closeBillingInfo)="d()"
    >
    </app-users-billing-info>
  </div> </ng-template
><!-- /.billing info modal ends -->
